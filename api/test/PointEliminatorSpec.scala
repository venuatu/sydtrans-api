import models.JsonFormat
import models.Types.Coord
import org.specs2.mutable._
import org.specs2.runner._
import org.junit.runner._
import play.api.libs.json._
import models._

import play.api.test._
import play.api.test.Helpers._

@RunWith(classOf[JUnitRunner])
class PointEliminatorSpec extends Specification {

  val original = Vector(
    Coord(-34.40802f,   150.87775f),
    Coord(-34.40811f,   150.87856f),
    Coord(-34.4081f,    150.87877f),
    Coord(-34.40853f,   150.88237f),
    Coord(-34.40847f,   150.88243f),
    Coord(-34.40848f,   150.8825f),
    Coord(-34.40853f,   150.88255f),
    Coord(-34.40858f,   150.88254f),
    Coord(-34.40862f,   150.88243f),
    Coord(-34.40987f,   150.88226f),
    Coord(-34.41046f,   150.88216f),
    Coord(-34.41069f,   150.88214f),
    Coord(-34.41071f,   150.88225f),
    Coord(-34.41077f,   150.88228f),
    Coord(-34.41088f,   150.88333f),
    Coord(-34.41085f,   150.88335f),
    Coord(-34.41083f,   150.88342f),
    Coord(-34.41085f,   150.88347f),
    Coord(-34.41089f,   150.88348f),
    Coord(-34.41102f,   150.8844f),
    Coord(-34.411118f,  150.88467f),
    Coord(-34.41123f,   150.88489f),
    Coord(-34.4114f,    150.8851f),
    Coord(-34.41104f,   150.88565f),
    Coord(-34.41104f,   150.88565f),
    Coord(-34.41099f,   150.88574f),
    Coord(-34.4109f,    150.88603f),
    Coord(-34.41089f,   150.8861f),
    Coord(-34.41086f,   150.88611f),
    Coord(-34.41082f,   150.88617f),
    Coord(-34.41084f,   150.88625f),
    Coord(-34.41089f,   150.88628f),
    Coord(-34.410927f,  150.88626f),
    Coord(-34.41139f,   150.88676f),
    Coord(-34.411747f,  150.88707f),
    Coord(-34.41192f,   150.88715f),
    Coord(-34.412098f,  150.88716f),
    Coord(-34.412216f,  150.88712f),
    Coord(-34.412315f,  150.88704f),
    Coord(-34.412617f,  150.88936f),
    Coord(-34.412777f,  150.89088f),
    Coord(-34.412327f,  150.89099f),
    Coord(-34.412327f,  150.89099f),
    Coord(-34.412777f,  150.89088f),
    Coord(-34.412617f,  150.88936f),
    Coord(-34.412235f,  150.88635f),
    Coord(-34.412205f,  150.88602f),
    Coord(-34.412254f,  150.88597f),
    Coord(-34.415215f,  150.88535f),
    Coord(-34.415215f,  150.88535f),
    Coord(-34.416325f,  150.88512f),
    Coord(-34.416355f,  150.88516f),
    Coord(-34.416435f,  150.88521f),
    Coord(-34.416485f,  150.88516f),
    Coord(-34.416504f,  150.88507f),
    Coord(-34.417545f,  150.88489f),
    Coord(-34.417545f,  150.88489f),
    Coord(-34.419296f,  150.88458f),
    Coord(-34.419716f,  150.88435f),
    Coord(-34.419777f,  150.88441f),
    Coord(-34.419846f,  150.88443f),
    Coord(-34.419914f,  150.88441f),
    Coord(-34.420013f,  150.8843f),
    Coord(-34.420013f,  150.8842f),
    Coord(-34.419975f,  150.88408f),
    Coord(-34.420174f,  150.88383f),
    Coord(-34.420563f,  150.88359f),
    Coord(-34.420563f,  150.88359f),
    Coord(-34.421143f,  150.88329f),
    Coord(-34.423172f,  150.88234f),
    Coord(-34.42332f,   150.88231f),
    Coord(-34.42348f,   150.88234f),
    Coord(-34.423832f,  150.88255f),
    Coord(-34.423794f,  150.88264f),
    Coord(-34.423805f,  150.8827f),
    Coord(-34.423824f,  150.88277f),
    Coord(-34.423916f,  150.88281f),
    Coord(-34.424007f,  150.88277f),
    Coord(-34.424038f,  150.8827f),
    Coord(-34.424038f,  150.88264f),
    Coord(-34.42523f,   150.88211f),
    Coord(-34.425877f,  150.88179f),
    Coord(-34.425346f,  150.88391f),
    Coord(-34.425278f,  150.88434f),
    Coord(-34.425278f,  150.88434f),
    Coord(-34.42523f,   150.88506f),
    Coord(-34.425247f,  150.88582f),
    Coord(-34.425316f,  150.8861f),
    Coord(-34.425766f,  150.88725f),
    Coord(-34.425797f,  150.88736f),
    Coord(-34.425827f,  150.88763f),
    Coord(-34.425667f,  150.88918f),
    Coord(-34.425667f,  150.88918f),
    Coord(-34.425568f,  150.89009f),
    Coord(-34.42545f,   150.89069f),
    Coord(-34.425068f,  150.89198f),
    Coord(-34.425068f,  150.89198f),
    Coord(-34.425f,     150.89223f),
    Coord(-34.42487f,   150.89305f),
    Coord(-34.425888f,  150.89278f),
    Coord(-34.426037f,  150.89285f),
    Coord(-34.426376f,  150.89531f),
    Coord(-34.426376f,  150.89531f),
    Coord(-34.42663f,   150.8971f),
    Coord(-34.42674f,   150.89772f),
    Coord(-34.42677f,   150.89796f),
    Coord(-34.42677f,   150.89796f),
    Coord(-34.42696f,   150.89952f),
    Coord(-34.42374f,   150.90018f),
    Coord(-34.42374f,   150.90018f),
    Coord(-34.4225f,    150.90044f),
    Coord(-34.4188f,    150.90118f),
    Coord(-34.41841f,   150.90105f),
    Coord(-34.41537f,   150.89941f),
    Coord(-34.41491f,   150.89952f),
    Coord(-34.414207f,  150.8996f),
    Coord(-34.414207f,  150.8996f),
    Coord(-34.41298f,   150.89972f),
    Coord(-34.41296f,   150.89964f),
    Coord(-34.4129f,    150.89961f),
    Coord(-34.41286f,   150.89961f),
    Coord(-34.41281f,   150.89966f),
    Coord(-34.41056f,   150.89677f),
    Coord(-34.4104f,    150.8967f),
    Coord(-34.41023f,   150.89668f),
    Coord(-34.40991f,   150.89673f),
    Coord(-34.409657f,  150.8968f),
    Coord(-34.409107f,  150.89705f),
    Coord(-34.406227f,  150.89919f),
    Coord(-34.405975f,  150.89934f),
    Coord(-34.405544f,  150.89952f),
    Coord(-34.405334f,  150.89958f),
    Coord(-34.401924f,  150.9003f),
    Coord(-34.401924f,  150.9003f),
    Coord(-34.399296f,  150.90082f),
    Coord(-34.398647f,  150.90085f),
    Coord(-34.396797f,  150.9008f),
    Coord(-34.396797f,  150.9008f),
    Coord(-34.39612f,   150.90079f),
    Coord(-34.394447f,  150.89455f),
    Coord(-34.394447f,  150.89455f),
    Coord(-34.393997f,  150.89282f),
    Coord(-34.395718f,  150.8925f),
    Coord(-34.397556f,  150.89223f),
    Coord(-34.400135f,  150.89174f),
    Coord(-34.400135f,  150.89174f),
    Coord(-34.401604f,  150.89142f),
    Coord(-34.402893f,  150.8911f),
    Coord(-34.402924f,  150.89119f),
    Coord(-34.403015f,  150.89124f),
    Coord(-34.403065f,  150.89122f),
    Coord(-34.403126f,  150.89116f),
    Coord(-34.405556f,  150.89069f),
    Coord(-34.405556f,  150.89069f),
    Coord(-34.405834f,  150.89062f),
    Coord(-34.406364f,  150.89061f),
    Coord(-34.406696f,  150.89064f),
    Coord(-34.406998f,  150.89072f),
    Coord(-34.407547f,  150.89091f),
    Coord(-34.407917f,  150.8911f),
    Coord(-34.408356f,  150.89137f),
    Coord(-34.408516f,  150.89095f),
    Coord(-34.409058f,  150.89021f),
    Coord(-34.40941f,   150.88965f),
    Coord(-34.40971f,   150.8893f),
    Coord(-34.41093f,   150.88751f),
    Coord(-34.41183f,   150.88611f),
    Coord(-34.41297f,   150.88441f),
    Coord(-34.41297f,   150.88437f),
    Coord(-34.41325f,   150.88354f),
    Coord(-34.41337f,   150.88281f),
    Coord(-34.41354f,   150.88199f),
    Coord(-34.41383f,   150.88142f),
    Coord(-34.41398f,   150.88124f),
    Coord(-34.41415f,   150.88116f),
    Coord(-34.4143f,    150.88123f),
    Coord(-34.414337f,  150.88132f),
    Coord(-34.41435f,   150.88145f),
    Coord(-34.414318f,  150.88158f),
    Coord(-34.413887f,  150.88208f),
    Coord(-34.413258f,  150.88242f),
    Coord(-34.412888f,  150.88252f),
    Coord(-34.41208f,   150.88268f),
    Coord(-34.410248f,  150.88281f),
    Coord(-34.40907f,   150.88293f),
    Coord(-34.40888f,   150.88292f),
    Coord(-34.408787f,  150.88289f),
    Coord(-34.40867f,   150.88274f),
    Coord(-34.4086f,    150.8825f),
    Coord(-34.40862f,   150.88239f),
    Coord(-34.408558f,  150.88234f),
    Coord(-34.408527f,  150.88235f),
    Coord(-34.408096f,  150.87875f),
    Coord(-34.408108f,  150.87854f),
    Coord(-34.408016f,  150.87773f)
  )

  "point eliminator" should {
    "get square distance" in {
      val result = PointEliminator.squareDistance(Coord(1f, 1f), Coord(5f, 5f))

      result must beEqualTo(32)
    }

    "eliminate points" in {
      val result = PointEliminator.simplifyRadialDist(original, 5e-8)

      result.length must beLessThan(original.length)
    }
  }

}
